<!doctypehtml><meta charset=utf8><meta content="IE=edge"http-equiv=X-UA-Compatible><title>threejs buffergeometry and skeleton clone</title><link href=/css.css rel=stylesheet><link href=/highlight.css rel=stylesheet><div class=container><h1 id=threejs-buffergeometry-and-skeleton-clone>threejs buffergeometry and skeleton clone</h1><p>for skinning we have set the 'skinIndex' and 'skinWeight' attribute for geometry <sup><a href=#user-content-fn-skinnedmesh aria-describedby=footnote-label data-footnote-ref id=user-content-fnref-skinnedmesh>1</a></sup><p><code>normal</code> attribute for lighting <code>position</code> attribute for position <code>skinIndex</code> indexs of bone position <code>skinWeight</code> weight of bone<p>if the geometry is indexed geometry, when we have clone the geometry we have to set index<pre><code class="hljs language-javascript"><span class=hljs-keyword>const</span> indexed = <span class=hljs-keyword>new</span> <span class="hljs-title hljs-class">BufferAttribute</span>() <span class=hljs-comment>// index buffer attribute</span>
<span class=hljs-keyword>const</span> geometry = <span class=hljs-keyword>new</span> <span class="hljs-constant hljs-variable">THREE</span>.<span class="hljs-title hljs-class">BufferGeometry</span>()
geometry.<span class="hljs-title hljs-function">setIndex</span>(indexed)

geometry.<span class="hljs-title hljs-function">setAttribute</span>(<span class=hljs-string>'position'</span>, attributefuffer) <span class=hljs-comment>// fake code for setting attribute</span>
geometry.<span class="hljs-title hljs-function">setAttribute</span>(<span class=hljs-string>'skinIndex'</span>, attributefuffer) <span class=hljs-comment>// fake code for setting attribute</span>
geometry.<span class="hljs-title hljs-function">setAttribute</span>(<span class=hljs-string>'skinWeight'</span>, attributefuffer) <span class=hljs-comment>// fake code for setting attribute</span>
geometry.<span class="hljs-title hljs-function">setAttribute</span>(<span class=hljs-string>'normal'</span>, attributefuffer) <span class=hljs-comment>// fake code for setting attribute</span>
</code></pre><p>to create and bind skeleton<pre><code class="hljs language-javascript"><span class=hljs-keyword>const</span> bones = [bone, bone] <span class=hljs-comment>// list of bones</span>
<span class=hljs-keyword>const</span> skeleton = <span class=hljs-keyword>new</span> <span class="hljs-constant hljs-variable">THREE</span>.<span class="hljs-title hljs-class">Skeleton</span>(bones)
<span class=hljs-keyword>const</span> skinmesh = <span class=hljs-keyword>new</span> <span class="hljs-constant hljs-variable">THREE</span>.<span class="hljs-title hljs-class">SkinnedMesh</span>( geometry, material);
skinmesh.<span class="hljs-title hljs-function">add</span>(bones[<span class=hljs-number>0</span>]) <span class=hljs-comment>// add root bone to scene or add to parent</span>
skinmesh.<span class="hljs-title hljs-function">bind</span>(skeleton)
</code></pre><p>skinmesh bind with default as 'attch' mode, would bind the mesh's worldmatrix, which result the mesh will stick to the skeleton position<hr><section class=footnotes data-footnotes><h2 class=sr-only id=footnote-label>Footnotes</h2><ol><li id=user-content-fn-skinnedmesh><p><a href="https://threejs.org/docs/index.html?q=skin#api/en/objects/SkinnedMesh">SkinnedMesh</a> <a href=#user-content-fnref-skinnedmesh aria-label="Back to content"class=data-footnote-backref data-footnote-backref>â†©</a></ol></section></div>